# Environment variables for dejafoo
# Copy this file to .env and update the values as needed

# =============================================================================
# CORE CONFIGURATION
# =============================================================================

# Upstream base URL (required)
UPSTREAM_BASE_URL=https://api.example.com

# Log level (TRACE, DEBUG, INFO, WARN, ERROR)
LOG_LEVEL=INFO

# Port to run the proxy on (for local development)
PORT=8080

# =============================================================================
# AWS CONFIGURATION
# =============================================================================

# AWS Region
AWS_REGION=us-east-1

# DynamoDB table name for cache storage
DYNAMODB_TABLE_NAME=dejafoo-cache

# S3 bucket name for large response storage
S3_BUCKET_NAME=dejafoo-cache-storage

# AWS credentials (if not using IAM roles)
# AWS_ACCESS_KEY_ID=your-access-key
# AWS_SECRET_ACCESS_KEY=your-secret-key

# =============================================================================
# CACHE CONFIGURATION
# =============================================================================

# Maximum body size for direct DynamoDB storage (bytes)
MAX_BODY_SIZE=10485760

# Cache policy configuration file path
CACHE_POLICY_CONFIG=config/policies.yaml

# Allowlist configuration file path
ALLOWLIST_CONFIG=config/allowlist.yaml

# Default cache TTL (seconds)
DEFAULT_CACHE_TTL=3600

# Cache cleanup interval (seconds)
CACHE_CLEANUP_INTERVAL=300

# =============================================================================
# PROXY CONFIGURATION
# =============================================================================

# Request timeout (seconds)
REQUEST_TIMEOUT=30

# Maximum number of redirects to follow
MAX_REDIRECTS=5

# User agent string for upstream requests
USER_AGENT=dejafoo-proxy/1.0

# =============================================================================
# SECURITY CONFIGURATION
# =============================================================================

# Enable rate limiting
RATE_LIMITING_ENABLED=true

# Rate limit: requests per minute
RATE_LIMIT_REQUESTS_PER_MINUTE=1000

# Rate limit: burst size
RATE_LIMIT_BURST_SIZE=100

# Enable CORS
CORS_ENABLED=true

# CORS allowed origins (comma-separated)
CORS_ALLOWED_ORIGINS=https://example.com,https://www.example.com

# =============================================================================
# MONITORING CONFIGURATION
# =============================================================================

# Enable metrics collection
METRICS_ENABLED=true

# Metrics endpoint path
METRICS_ENDPOINT=/metrics

# Health check endpoint path
HEALTH_ENDPOINT=/health

# Enable request/response logging
REQUEST_LOGGING_ENABLED=true

# Log sensitive headers (comma-separated)
SENSITIVE_HEADERS=authorization,x-api-key,cookie,set-cookie

# =============================================================================
# DEVELOPMENT CONFIGURATION
# =============================================================================

# Enable debug mode
DEBUG=false

# Enable request/response body logging
LOG_BODY=false

# Enable header logging
LOG_HEADERS=false

# Development upstream URL (overrides UPSTREAM_BASE_URL in dev mode)
DEV_UPSTREAM_URL=http://localhost:3000

# =============================================================================
# LAMBDA CONFIGURATION (for AWS Lambda deployment)
# =============================================================================

# Lambda function name
LAMBDA_FUNCTION_NAME=dejafoo-proxy

# Lambda timeout (seconds)
LAMBDA_TIMEOUT=30

# Lambda memory size (MB)
LAMBDA_MEMORY_SIZE=512

# Lambda environment
LAMBDA_ENVIRONMENT=production

# =============================================================================
# API GATEWAY CONFIGURATION
# =============================================================================

# API Gateway stage
API_GATEWAY_STAGE=prod

# API Gateway API ID
API_GATEWAY_API_ID=your-api-id

# API Gateway resource ID
API_GATEWAY_RESOURCE_ID=your-resource-id

# =============================================================================
# CLOUDFRONT CONFIGURATION (if using CloudFront)
# =============================================================================

# CloudFront distribution ID
CLOUDFRONT_DISTRIBUTION_ID=your-distribution-id

# CloudFront cache policy ID
CLOUDFRONT_CACHE_POLICY_ID=your-cache-policy-id

# =============================================================================
# EXTERNAL SERVICES
# =============================================================================

# External cache service URL (Redis, Memcached, etc.)
# EXTERNAL_CACHE_URL=redis://localhost:6379

# External metrics service URL (Prometheus, CloudWatch, etc.)
# METRICS_SERVICE_URL=http://localhost:9090

# External logging service URL (ELK, Splunk, etc.)
# LOGGING_SERVICE_URL=http://localhost:9200

# =============================================================================
# FEATURE FLAGS
# =============================================================================

# Enable cache compression
CACHE_COMPRESSION_ENABLED=true

# Enable response streaming
RESPONSE_STREAMING_ENABLED=false

# Enable request batching
REQUEST_BATCHING_ENABLED=false

# Enable circuit breaker
CIRCUIT_BREAKER_ENABLED=true

# Circuit breaker failure threshold
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5

# Circuit breaker timeout (seconds)
CIRCUIT_BREAKER_TIMEOUT=60

# =============================================================================
# PERFORMANCE TUNING
# =============================================================================

# Connection pool size
CONNECTION_POOL_SIZE=100

# Keep-alive timeout (seconds)
KEEP_ALIVE_TIMEOUT=30

# TCP keep-alive interval (seconds)
TCP_KEEP_ALIVE_INTERVAL=30

# Maximum concurrent requests
MAX_CONCURRENT_REQUESTS=1000

# Request queue size
REQUEST_QUEUE_SIZE=10000

# =============================================================================
# BACKUP AND RECOVERY
# =============================================================================

# Enable cache backup
CACHE_BACKUP_ENABLED=false

# Cache backup interval (seconds)
CACHE_BACKUP_INTERVAL=3600

# Cache backup retention (days)
CACHE_BACKUP_RETENTION=7

# Backup storage location
BACKUP_STORAGE_LOCATION=s3://your-backup-bucket
